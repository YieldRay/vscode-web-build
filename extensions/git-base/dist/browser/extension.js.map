{"version":3,"file":"extension.js","mappings":"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","sources":["webpack://git-base/./src/remoteSource.ts","webpack://git-base/./src/api/api1.ts","webpack://git-base/external commonjs \"vscode\"","webpack://git-base/./src/decorators.ts","webpack://git-base/./src/model.ts","webpack://git-base/./src/api/extension.ts","webpack://git-base/./src/util.ts","webpack://git-base/webpack/bootstrap","webpack://git-base/./src/extension.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { QuickPickItem, window, QuickPick, QuickPickItemKind, l10n, Disposable } from 'vscode';\nimport { RemoteSourceProvider, RemoteSource, PickRemoteSourceOptions, PickRemoteSourceResult, RemoteSourceAction } from './api/git-base';\nimport { Model } from './model';\nimport { throttle, debounce } from './decorators';\n\nasync function getQuickPickResult<T extends QuickPickItem>(quickpick: QuickPick<T>): Promise<T | undefined> {\n\tconst listeners: Disposable[] = [];\n\tconst result = await new Promise<T | undefined>(c => {\n\t\tlisteners.push(\n\t\t\tquickpick.onDidAccept(() => c(quickpick.selectedItems[0])),\n\t\t\tquickpick.onDidHide(() => c(undefined)),\n\t\t);\n\t\tquickpick.show();\n\t});\n\n\tquickpick.hide();\n\tlisteners.forEach(l => l.dispose());\n\treturn result;\n}\n\nclass RemoteSourceProviderQuickPick implements Disposable {\n\n\tprivate disposables: Disposable[] = [];\n\tprivate isDisposed: boolean = false;\n\n\tprivate quickpick: QuickPick<QuickPickItem & { remoteSource?: RemoteSource }> | undefined;\n\n\tconstructor(private provider: RemoteSourceProvider) { }\n\n\tdispose() {\n\t\tthis.disposables.forEach(d => d.dispose());\n\t\tthis.disposables = [];\n\t\tthis.quickpick = undefined;\n\t\tthis.isDisposed = true;\n\t}\n\n\tprivate ensureQuickPick() {\n\t\tif (!this.quickpick) {\n\t\t\tthis.quickpick = window.createQuickPick();\n\t\t\tthis.disposables.push(this.quickpick);\n\t\t\tthis.quickpick.ignoreFocusOut = true;\n\t\t\tthis.disposables.push(this.quickpick.onDidHide(() => this.dispose()));\n\t\t\tif (this.provider.supportsQuery) {\n\t\t\t\tthis.quickpick.placeholder = this.provider.placeholder ?? l10n.t('Repository name (type to search)');\n\t\t\t\tthis.disposables.push(this.quickpick.onDidChangeValue(this.onDidChangeValue, this));\n\t\t\t} else {\n\t\t\t\tthis.quickpick.placeholder = this.provider.placeholder ?? l10n.t('Repository name');\n\t\t\t}\n\t\t}\n\t}\n\n\t@debounce(300)\n\tprivate onDidChangeValue(): void {\n\t\tthis.query();\n\t}\n\n\t@throttle\n\tprivate async query(): Promise<void> {\n\t\ttry {\n\t\t\tif (this.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.ensureQuickPick();\n\t\t\tthis.quickpick!.busy = true;\n\t\t\tthis.quickpick!.show();\n\n\t\t\tconst remoteSources = await this.provider.getRemoteSources(this.quickpick?.value) || [];\n\t\t\t// The user may have cancelled the picker in the meantime\n\t\t\tif (this.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (remoteSources.length === 0) {\n\t\t\t\tthis.quickpick!.items = [{\n\t\t\t\t\tlabel: l10n.t('No remote repositories found.'),\n\t\t\t\t\talwaysShow: true\n\t\t\t\t}];\n\t\t\t} else {\n\t\t\t\tthis.quickpick!.items = remoteSources.map(remoteSource => ({\n\t\t\t\t\tlabel: remoteSource.icon ? `$(${remoteSource.icon}) ${remoteSource.name}` : remoteSource.name,\n\t\t\t\t\tdescription: remoteSource.description || (typeof remoteSource.url === 'string' ? remoteSource.url : remoteSource.url[0]),\n\t\t\t\t\tdetail: remoteSource.detail,\n\t\t\t\t\tremoteSource,\n\t\t\t\t\talwaysShow: true\n\t\t\t\t}));\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tthis.quickpick!.items = [{ label: l10n.t('{0} Error: {1}', '$(error)', err.message), alwaysShow: true }];\n\t\t\tconsole.error(err);\n\t\t} finally {\n\t\t\tif (!this.isDisposed) {\n\t\t\t\tthis.quickpick!.busy = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync pick(): Promise<RemoteSource | undefined> {\n\t\tawait this.query();\n\t\tif (this.isDisposed) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = await getQuickPickResult(this.quickpick!);\n\t\treturn result?.remoteSource;\n\t}\n}\n\nexport async function getRemoteSourceActions(model: Model, url: string): Promise<RemoteSourceAction[]> {\n\tconst providers = model.getRemoteProviders();\n\n\tconst remoteSourceActions = [];\n\tfor (const provider of providers) {\n\t\tconst providerActions = await provider.getRemoteSourceActions?.(url);\n\t\tif (providerActions?.length) {\n\t\t\tremoteSourceActions.push(...providerActions);\n\t\t}\n\t}\n\n\treturn remoteSourceActions;\n}\n\nexport async function pickRemoteSource(model: Model, options: PickRemoteSourceOptions & { branch?: false | undefined }): Promise<string | undefined>;\nexport async function pickRemoteSource(model: Model, options: PickRemoteSourceOptions & { branch: true }): Promise<PickRemoteSourceResult | undefined>;\nexport async function pickRemoteSource(model: Model, options: PickRemoteSourceOptions = {}): Promise<string | PickRemoteSourceResult | undefined> {\n\tconst quickpick = window.createQuickPick<(QuickPickItem & { provider?: RemoteSourceProvider; url?: string })>();\n\tquickpick.title = options.title;\n\n\tif (options.providerName) {\n\t\tconst provider = model.getRemoteProviders()\n\t\t\t.filter(provider => provider.name === options.providerName)[0];\n\n\t\tif (provider) {\n\t\t\treturn await pickProviderSource(provider, options);\n\t\t}\n\t}\n\n\tconst remoteProviders = model.getRemoteProviders()\n\t\t.map(provider => ({ label: (provider.icon ? `$(${provider.icon}) ` : '') + (options.providerLabel ? options.providerLabel(provider) : provider.name), alwaysShow: true, provider }));\n\n\tconst recentSources: (QuickPickItem & { url?: string; timestamp: number })[] = [];\n\tif (options.showRecentSources) {\n\t\tfor (const { provider } of remoteProviders) {\n\t\t\tconst sources = (await provider.getRecentRemoteSources?.() ?? []).map((item) => {\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\tlabel: (item.icon ? `$(${item.icon}) ` : '') + item.name,\n\t\t\t\t\turl: typeof item.url === 'string' ? item.url : item.url[0],\n\t\t\t\t};\n\t\t\t});\n\t\t\trecentSources.push(...sources);\n\t\t}\n\t}\n\n\tconst items = [\n\t\t{ kind: QuickPickItemKind.Separator, label: l10n.t('remote sources') },\n\t\t...remoteProviders,\n\t\t{ kind: QuickPickItemKind.Separator, label: l10n.t('recently opened') },\n\t\t...recentSources.sort((a, b) => b.timestamp - a.timestamp)\n\t];\n\n\tquickpick.placeholder = options.placeholder ?? (remoteProviders.length === 0\n\t\t? l10n.t('Provide repository URL')\n\t\t: l10n.t('Provide repository URL or pick a repository source.'));\n\n\tconst updatePicks = (value?: string) => {\n\t\tif (value) {\n\t\t\tconst label = (typeof options.urlLabel === 'string' ? options.urlLabel : options.urlLabel?.(value)) ?? l10n.t('URL');\n\t\t\tquickpick.items = [{\n\t\t\t\tlabel: label,\n\t\t\t\tdescription: value,\n\t\t\t\talwaysShow: true,\n\t\t\t\turl: value\n\t\t\t},\n\t\t\t...items\n\t\t\t];\n\t\t} else {\n\t\t\tquickpick.items = items;\n\t\t}\n\t};\n\n\tquickpick.onDidChangeValue(updatePicks);\n\tupdatePicks();\n\n\tconst result = await getQuickPickResult(quickpick);\n\n\tif (result) {\n\t\tif (result.url) {\n\t\t\treturn result.url;\n\t\t} else if (result.provider) {\n\t\t\treturn await pickProviderSource(result.provider, options);\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nasync function pickProviderSource(provider: RemoteSourceProvider, options: PickRemoteSourceOptions = {}): Promise<string | PickRemoteSourceResult | undefined> {\n\tconst quickpick = new RemoteSourceProviderQuickPick(provider);\n\tconst remote = await quickpick.pick();\n\tquickpick.dispose();\n\n\tlet url: string | undefined;\n\n\tif (remote) {\n\t\tif (typeof remote.url === 'string') {\n\t\t\turl = remote.url;\n\t\t} else if (remote.url.length > 0) {\n\t\t\turl = await window.showQuickPick(remote.url, { ignoreFocusOut: true, placeHolder: l10n.t('Choose a URL to clone from.') });\n\t\t}\n\t}\n\n\tif (!url || !options.branch) {\n\t\treturn url;\n\t}\n\n\tif (!provider.getBranches) {\n\t\treturn { url };\n\t}\n\n\tconst branches = await provider.getBranches(url);\n\n\tif (!branches) {\n\t\treturn { url };\n\t}\n\n\tconst branch = await window.showQuickPick(branches, {\n\t\tplaceHolder: l10n.t('Branch name')\n\t});\n\n\tif (!branch) {\n\t\treturn { url };\n\t}\n\n\treturn { url, branch };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, commands } from 'vscode';\nimport { Model } from '../model';\nimport { getRemoteSourceActions, pickRemoteSource } from '../remoteSource';\nimport { GitBaseExtensionImpl } from './extension';\nimport { API, PickRemoteSourceOptions, PickRemoteSourceResult, RemoteSourceAction, RemoteSourceProvider } from './git-base';\n\nexport class ApiImpl implements API {\n\n\tconstructor(private _model: Model) { }\n\n\tpickRemoteSource(options: PickRemoteSourceOptions): Promise<PickRemoteSourceResult | string | undefined> {\n\t\treturn pickRemoteSource(this._model, options as any);\n\t}\n\n\tgetRemoteSourceActions(url: string): Promise<RemoteSourceAction[]> {\n\t\treturn getRemoteSourceActions(this._model, url);\n\t}\n\n\tregisterRemoteSourceProvider(provider: RemoteSourceProvider): Disposable {\n\t\treturn this._model.registerRemoteSourceProvider(provider);\n\t}\n}\n\nexport function registerAPICommands(extension: GitBaseExtensionImpl): Disposable {\n\tconst disposables: Disposable[] = [];\n\n\tdisposables.push(commands.registerCommand('git-base.api.getRemoteSources', (opts?: PickRemoteSourceOptions) => {\n\t\tif (!extension.model) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn pickRemoteSource(extension.model, opts as any);\n\t}));\n\n\treturn Disposable.from(...disposables);\n}\n","module.exports = require(\"vscode\");","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { done } from './util';\n\nexport function debounce(delay: number): Function {\n\treturn decorate((fn, key) => {\n\t\tconst timerKey = `$debounce$${key}`;\n\n\t\treturn function (this: any, ...args: any[]) {\n\t\t\tclearTimeout(this[timerKey]);\n\t\t\tthis[timerKey] = setTimeout(() => fn.apply(this, args), delay);\n\t\t};\n\t});\n}\n\nexport const throttle = decorate(_throttle);\n\nfunction _throttle<T>(fn: Function, key: string): Function {\n\tconst currentKey = `$throttle$current$${key}`;\n\tconst nextKey = `$throttle$next$${key}`;\n\n\tconst trigger = function (this: any, ...args: any[]) {\n\t\tif (this[nextKey]) {\n\t\t\treturn this[nextKey];\n\t\t}\n\n\t\tif (this[currentKey]) {\n\t\t\tthis[nextKey] = done(this[currentKey]).then(() => {\n\t\t\t\tthis[nextKey] = undefined;\n\t\t\t\treturn trigger.apply(this, args);\n\t\t\t});\n\n\t\t\treturn this[nextKey];\n\t\t}\n\n\t\tthis[currentKey] = fn.apply(this, args) as Promise<T>;\n\n\t\tconst clear = () => this[currentKey] = undefined;\n\t\tdone(this[currentKey]).then(clear, clear);\n\n\t\treturn this[currentKey];\n\t};\n\n\treturn trigger;\n}\n\nfunction decorate(decorator: (fn: Function, key: string) => Function): Function {\n\treturn function (original: any, context: ClassMethodDecoratorContext) {\n\t\tif (context.kind !== 'method') {\n\t\t\tthrow new Error('not supported');\n\t\t}\n\t\treturn decorator(original, context.name.toString());\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { EventEmitter, Disposable } from 'vscode';\nimport { toDisposable } from './util';\nimport { RemoteSourceProvider } from './api/git-base';\nimport { IRemoteSourceProviderRegistry } from './remoteProvider';\n\nexport class Model implements IRemoteSourceProviderRegistry {\n\n\tprivate remoteSourceProviders = new Set<RemoteSourceProvider>();\n\n\tprivate _onDidAddRemoteSourceProvider = new EventEmitter<RemoteSourceProvider>();\n\treadonly onDidAddRemoteSourceProvider = this._onDidAddRemoteSourceProvider.event;\n\n\tprivate _onDidRemoveRemoteSourceProvider = new EventEmitter<RemoteSourceProvider>();\n\treadonly onDidRemoveRemoteSourceProvider = this._onDidRemoveRemoteSourceProvider.event;\n\n\tregisterRemoteSourceProvider(provider: RemoteSourceProvider): Disposable {\n\t\tthis.remoteSourceProviders.add(provider);\n\t\tthis._onDidAddRemoteSourceProvider.fire(provider);\n\n\t\treturn toDisposable(() => {\n\t\t\tthis.remoteSourceProviders.delete(provider);\n\t\t\tthis._onDidRemoveRemoteSourceProvider.fire(provider);\n\t\t});\n\t}\n\n\tgetRemoteProviders(): RemoteSourceProvider[] {\n\t\treturn [...this.remoteSourceProviders.values()];\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Model } from '../model';\nimport { GitBaseExtension, API } from './git-base';\nimport { Event, EventEmitter } from 'vscode';\nimport { ApiImpl } from './api1';\n\nexport class GitBaseExtensionImpl implements GitBaseExtension {\n\n\tenabled: boolean = false;\n\n\tprivate _onDidChangeEnablement = new EventEmitter<boolean>();\n\treadonly onDidChangeEnablement: Event<boolean> = this._onDidChangeEnablement.event;\n\n\tprivate _model: Model | undefined = undefined;\n\n\tset model(model: Model | undefined) {\n\t\tthis._model = model;\n\n\t\tconst enabled = !!model;\n\n\t\tif (this.enabled === enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = enabled;\n\t\tthis._onDidChangeEnablement.fire(this.enabled);\n\t}\n\n\tget model(): Model | undefined {\n\t\treturn this._model;\n\t}\n\n\tconstructor(model?: Model) {\n\t\tif (model) {\n\t\t\tthis.enabled = true;\n\t\t\tthis._model = model;\n\t\t}\n\t}\n\n\tgetAPI(version: number): API {\n\t\tif (!this._model) {\n\t\t\tthrow new Error('Git model not found');\n\t\t}\n\n\t\tif (version !== 1) {\n\t\t\tthrow new Error(`No API version ${version} found.`);\n\t\t}\n\n\t\treturn new ApiImpl(this._model);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface IDisposable {\n\tdispose(): void;\n}\n\nexport function toDisposable(dispose: () => void): IDisposable {\n\treturn { dispose };\n}\n\nexport function done<T>(promise: Promise<T>): Promise<void> {\n\treturn promise.then<void>(() => undefined);\n}\n\nexport namespace Versions {\n\tdeclare type VersionComparisonResult = -1 | 0 | 1;\n\n\texport interface Version {\n\t\tmajor: number;\n\t\tminor: number;\n\t\tpatch: number;\n\t\tpre?: string;\n\t}\n\n\texport function compare(v1: string | Version, v2: string | Version): VersionComparisonResult {\n\t\tif (typeof v1 === 'string') {\n\t\t\tv1 = fromString(v1);\n\t\t}\n\t\tif (typeof v2 === 'string') {\n\t\t\tv2 = fromString(v2);\n\t\t}\n\n\t\tif (v1.major > v2.major) { return 1; }\n\t\tif (v1.major < v2.major) { return -1; }\n\n\t\tif (v1.minor > v2.minor) { return 1; }\n\t\tif (v1.minor < v2.minor) { return -1; }\n\n\t\tif (v1.patch > v2.patch) { return 1; }\n\t\tif (v1.patch < v2.patch) { return -1; }\n\n\t\tif (v1.pre === undefined && v2.pre !== undefined) { return 1; }\n\t\tif (v1.pre !== undefined && v2.pre === undefined) { return -1; }\n\n\t\tif (v1.pre !== undefined && v2.pre !== undefined) {\n\t\t\treturn v1.pre.localeCompare(v2.pre) as VersionComparisonResult;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\texport function from(major: string | number, minor: string | number, patch?: string | number, pre?: string): Version {\n\t\treturn {\n\t\t\tmajor: typeof major === 'string' ? parseInt(major, 10) : major,\n\t\t\tminor: typeof minor === 'string' ? parseInt(minor, 10) : minor,\n\t\t\tpatch: patch === undefined || patch === null ? 0 : typeof patch === 'string' ? parseInt(patch, 10) : patch,\n\t\t\tpre: pre,\n\t\t};\n\t}\n\n\texport function fromString(version: string): Version {\n\t\tconst [ver, pre] = version.split('-');\n\t\tconst [major, minor, patch] = ver.split('.');\n\t\treturn from(major, minor, patch, pre);\n\t}\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ExtensionContext } from 'vscode';\nimport { registerAPICommands } from './api/api1';\nimport { GitBaseExtensionImpl } from './api/extension';\nimport { Model } from './model';\n\nexport function activate(context: ExtensionContext): GitBaseExtensionImpl {\n\tconst apiImpl = new GitBaseExtensionImpl(new Model());\n\tcontext.subscriptions.push(registerAPICommands(apiImpl));\n\n\treturn apiImpl;\n}\n"],"names":["async","model","url","providers","getRemoteProviders","remoteSourceActions","provider","providerActions","getRemoteSourceActions","length","push","options","quickpick","window","createQuickPick","title","providerName","filter","name","pickProviderSource","remoteProviders","map","label","icon","providerLabel","alwaysShow","recentSources","showRecentSources","sources","getRecentRemoteSources","item","items","kind","QuickPickItemKind","Separator","l10n","t","sort","a","b","timestamp","placeholder","updatePicks","value","urlLabel","description","onDidChangeValue","result","getQuickPickResult","listeners","Promise","c","onDidAccept","selectedItems","onDidHide","undefined","show","hide","forEach","l","dispose","RemoteSourceProviderQuickPick","debounce","throttle","private","query","disposables","isDisposed","constructor","this","d","ensureQuickPick","ignoreFocusOut","supportsQuery","busy","remoteSources","getRemoteSources","remoteSource","detail","err","message","console","error","pick","remote","showQuickPick","placeHolder","branch","getBranches","branches","extension","commands","registerCommand","opts","pickRemoteSource","Disposable","from","_model","registerRemoteSourceProvider","module","exports","require","delay","decorate","fn","key","timerKey","args","clearTimeout","setTimeout","apply","decorator","original","context","Error","toString","currentKey","nextKey","trigger","done","then","clear","remoteSourceProviders","Set","_onDidAddRemoteSourceProvider","EventEmitter","onDidAddRemoteSourceProvider","event","_onDidRemoveRemoteSourceProvider","onDidRemoveRemoteSourceProvider","add","fire","toDisposable","delete","values","enabled","_onDidChangeEnablement","onDidChangeEnablement","getAPI","version","ApiImpl","Versions","promise","major","minor","patch","pre","parseInt","fromString","ver","split","compare","v1","v2","localeCompare","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","apiImpl","GitBaseExtensionImpl","Model","subscriptions","registerAPICommands"],"sourceRoot":""}